{{ form_start(form) }}
<div class="row">
    <div class="col-md-8">{{ form_row(form.nom) }}</div>
    <div class="col-md-4">{{ form_row(form.fournisseur) }}</div>
</div>
<div class="row">
    <div class="col-md-6">
        {{ form_row(form.categorieParent) }}
        <div id="category-container" class="mt-2"></div>
        <div style="display: none;">
            {{ form_row(form.categorie) }}
        </div>
    </div>
    <div class="col-md-6">{{ form_row(form.uniteDeBase) }}</div>
</div>
<div class="row">
    <div class="col-md-6">{{ form_row(form.prixVente) }}</div>
    <div class="col-md-6">{{ form_row(form.stockMinimum) }}</div>
</div>

<h3 class="mt-4">Lots du produit</h3> {# Added #}

{% set prototype_lot_html %}
    {% set prototype_lot_form = form.lots.vars.prototype %}
    <div class='list-group-item'>
        {{ form_errors(prototype_lot_form) }}
        <div class='row'>
            <div class='col'>{{ form_row(prototype_lot_form.numeroLot) }}</div>
            <div class='col'>{{ form_row(prototype_lot_form.quantite) }}</div>
            <div class='col'>{{ form_row(prototype_lot_form.datePeremption) }}</div>
            <div class='col'>{{ form_row(prototype_lot_form.prixAchat) }}</div>
            <div class='col-auto d-flex align-items-end'>
                <button type='button' class='btn btn-danger remove-collection-widget'>Supprimer</button>
            </div>
        </div>
    </div>
{% endset %}

<div id="lots"
     class="list-group"
     data-prototype="{{ prototype_lot_html|e('html_attr') }}"
     data-widget-tags="{{ '<div class="list-group-item"></div>'|e('html_attr') }}"
     data-widget-counter="{{ form['lots']|length }}">

    {% for lotForm in form['lots'] %}
        <div class="list-group-item">
            {{ form_errors(lotForm) }}
            <div class="row">
                <div class="col">{{ form_row(lotForm.numeroLot) }}</div>
                <div class="col">{{ form_row(lotForm.quantite) }}</div>
                <div class="col">{{ form_row(lotForm.datePeremption) }}</div>
                <div class="col">{{ form_row(lotForm.prixAchat) }}</div>
                <div class="col-auto d-flex align-items-end'>
                    <button type="button" class="btn btn-danger remove-collection-widget">Supprimer</button>
                </div>
            </div>
        </div>
    {% endfor %}
</div>

<button type="button" class="btn btn-secondary add-collection-widget mt-2" data-list-selector="#lots">Ajouter un lot</button>

<h3 class="mt-4">Conditionnements</h3>

{% set prototype_html %}
    {% set prototype_form = form.conditionnements.vars.prototype %}
    <div class='list-group-item'>
        {{ form_errors(prototype_form) }}
        <div class='row'>
            <div class='col'>{{ form_row(prototype_form.unite) }}</div>
            <div class='col'>{{ form_row(prototype_form.quantite) }}</div>
            <div class='col'>{{ form_row(prototype_form.prixVente) }}</div>
            <div class='col-auto d-flex align-items-end'>
                <button type='button' class='btn btn-danger remove-collection-widget'>Supprimer</button>
            </div>
        </div>
    </div>
{% endset %}

<div id="conditionnements" 
     class="list-group" 
     data-prototype="{{ prototype_html|e('html_attr') }}"
     data-widget-tags="{{ '<div class="list-group-item"></div>'|e('html_attr') }}"
     data-widget-counter="{{ form['conditionnements']|length }}">
    
    {% for conditionnementForm in form['conditionnements'] %}
        <div class="list-group-item">
            {{ form_errors(conditionnementForm) }}
            <div class="row">
                <div class="col">{{ form_row(conditionnementForm.unite) }}</div>
                <div class="col">{{ form_row(conditionnementForm.quantite) }}</div>
                <div class="col">{{ form_row(conditionnementForm.prixVente) }}</div>
                <div class="col-auto d-flex align-items-end">
                    <button type="button" class="btn btn-danger remove-collection-widget">Supprimer</button>
                </div>
            </div>
        </div>
    {% endfor %}
</div>

<button type="button" class="btn btn-secondary add-collection-widget mt-2" data-list-selector="#conditionnements">Ajouter un conditionnement</button>
<div class="text-end mt-4">

	<button class="btn btn-primary">{{ button_label|default('Enregistrer') }}</button>

</div>

{{ form_end(form) }}




